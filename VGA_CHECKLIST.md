# VGA表示されない時のチェックリスト

## ✅ 実行してください

### 1. Gowin EDAでプロジェクトを確認

#### プロジェクトに正しいファイルが追加されているか確認:
- [ ] VGA_BW_simple.v が追加されている
- [ ] VGA_BW_top_Tang25K.v が追加されている  
- [ ] Tang_Primer_25K_VGA.cst が追加されている

#### トップモジュールが設定されているか:
- [ ] VGA_BW_top_Tang25K.v が **太字** になっている
- [ ] 右クリック → "Set as Top Module" で設定済み

### 2. 再ビルド（必須！）

**重要**: ファイルを更新したので必ず再ビルドしてください

```
① Synthesize (緑のチェックマーク) - エラーがないこと確認
② Place & Route (青い基板マーク) - 成功を確認
③ Program/Configure - FPGAに書き込み
```

### 3. ハードウェア配線を再確認

#### VGA配線:
```
Tang Primer 25K → VGA コネクタ
─────────────────────────────
E11 (HSYNC)     → Pin 13
D11 (VSYNC)     → Pin 14
C11 (VIDEO) ┬─[270Ω]→ Pin 1 (R)
            ├─[270Ω]→ Pin 2 (G)
            └─[270Ω]→ Pin 3 (B)
GND         → Pin 5,6,7,8,10
```

#### 確認項目:
- [ ] 抵抗は270Ωを使用（220Ω～470ΩならOK）
- [ ] GNDが**必ず**接続されている
- [ ] VGAケーブルがモニターに接続されている
- [ ] モニターの電源が入っている

### 4. リセットボタンの状態

Tang Primer 25KのS1ボタンは**押さないで**ください。

- リセットボタンを押している間 → リセット状態（何も映らない）
- リセットボタンを離す → 動作開始

### 5. モニターの設定

- [ ] モニターの入力を VGA/D-Sub に切り替え
- [ ] 640x480@60Hz に対応しているモニターか確認
- [ ] 可能なら別のモニターでも試す

---

## 🔬 デバッグパターン

### パターン1: 全画面白テスト

画面が本当に動いていないのか確認するため、全画面白に変更：

`VGA_BW_simple.v` の 113行目付近を変更:
```verilog
always @(posedge clk_25mhz) begin
    if (display_on) begin
        // video <= h_count[5] ^ v_count[5];  // コメントアウト
        video <= 1'b1;  // 全画面白に変更
    end else begin
        video <= 1'b0;
    end
end
```

→ 再ビルド → 書き込み

**期待結果**: 画面全体が白くなる

### パターン2: LEDデバッグ（もしTang Primer 25KにLEDがあれば）

トップモジュールに以下を追加:
```verilog
output wire led;
assign led = video_signal;
```

LEDが点滅 → 映像信号は生成されている

---

## 🆘 まだ映らない場合

### 可能性のある原因:

1. **ピン配置が間違っている**
   - Tang Primer 25Kの回路図で実際のピン番号を確認
   - E11, D11, C11, B11, A11 が正しいか

2. **配線の問題**
   - テスターで導通確認（特にGND）
   - ジャンパー線の断線確認

3. **モニターの問題**
   - 640x480@60Hzに対応していない古いモニター
   - VGAケーブルの断線

4. **FPGAの書き込みが失敗している**
   - Programmer で "Program done" が表示されたか確認
   - SRAMモードは電源を切ると消える

---

## 📝 修正した内容

今回修正したのは **HSYNC/VSYNCの極性** です:

```verilog
// ❌ 以前（間違い）
if (同期期間中)
    hsync <= 1'b1;  // High（間違い！）

// ✅ 修正後（正しい）
if (同期期間中)
    hsync <= 1'b0;  // Low（VGA標準）
```

VGA規格では、HSYNC/VSYNCは**負極性**（同期期間中にLow）が標準です。

---

**作成日**: 2026-02-12  
**対象**: Tang Primer 25K VGA表示トラブルシューティング
