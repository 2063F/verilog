# オシロスコープ診断ガイド

## 📊 測定すべき値

### HSYNC信号
```
理想値（25.175MHz時）:
- 周期: 31.77μs
- パルス幅: 3.84μs
- 極性: 負（通常High、同期時Low）

27MHz使用時:
- 周期: 29.63μs（-6.7%）
- パルス幅: 3.58μs
- 極性: 負（通常High、同期時Low）
```

### VSYNC信号
```
理想値:
- 周期: 16.68ms (60Hz)
- パルス幅: 63μs
- 極性: 負（通常High、同期時Low）

27MHz使用時:
- 周期: 15.56ms (64.3Hz)
- パルス幅: 59μs
```

---

## 🔴 「映像出力なし」の主な原因

### 原因1: クロック周波数が規格外（可能性70%）

**症状**: オシロで信号は見えるが、モニターが認識しない

**診断**:
- HSYNC周期が29.63μsなら27MHz使用中
- モニターが厳格な仕様チェックをしている

**解決策**: PLLで25.175MHzを生成

### 原因2: HSYNC/VSYNC極性が逆（可能性20%）

**症状**: 信号は出ているが極性が逆

**診断**: オシロで確認
```
正しい（負極性）:
  ━━━━━━┓____┏━━━━━━
  (High)  (Low) (High)
  
間違い（正極性）:
  ______┏━━━━┓______
  (Low) (High)(Low)
```

**解決策**: VGA_BW_simple.vの極性を反転

### 原因3: HSYNC/VSYNCピンが逆（可能性10%）

**診断**: 
- HSYNCの周期が16ms → VSYNCとHSYNCが逆
- VSYNCの周期が30μs → 逆配線

**解決策**: ピン配線を入れ替える

---

## ✅ チェックリスト

### オシロスコープで確認
- [ ] HSYNC周期: _____ μs
- [ ] HSYNC パルス幅: _____ μs  
- [ ] HSYNC 極性: High通常 / Low通常
- [ ] VSYNC周期: _____ ms
- [ ] VSYNC パルス幅: _____ μs
- [ ] VSYNC 極性: High通常 / Low通常
- [ ] VIDEO信号が変化している

### 配線確認
- [ ] HSYNC → VGA Pin 13
- [ ] VSYNC → VGA Pin 14
- [ ] 上記が逆になっていないか

### モニター確認
- [ ] 他のモニターでも試した
- [ ] VGA入力に切り替えた
- [ ] モニターの対応解像度を確認

---

## 🔧 即効性のある対処法

### 対処法1: 極性を試しに反転してみる

`VGA_BW_simple.v` の80-82行目と92-94行目:

```verilog
// 現在（負極性）
if (同期期間中)
    hsync <= 1'b0;  // Low
else
    hsync <= 1'b1;  // High

// 試しに反転（正極性）
if (同期期間中)
    hsync <= 1'b1;  // High
else
    hsync <= 1'b0;  // Low
```

### 対処法2: HSYNC/VSYNCピンを入れ替え

`.cst`ファイルで:
```cst
# 現在
IO_LOC "vga_hsync" E11;
IO_LOC "vga_vsync" D11;

# 入れ替え
IO_LOC "vga_hsync" D11;
IO_LOC "vga_vsync" E11;
```

### 対処法3: PLLを使用（根本解決）

Gowin EDAでPLLを生成:
1. Tools → IP Core Generator
2. Clock → PLL
3. Input: 27MHz
4. Output: 25.175MHz
5. Generate

---

## 📝 報告フォーマット

以下の情報を教えてください：

```
【オシロ測定値】
HSYNC周期: ______ μs
HSYNC パルス: ______ μs
HSYNC 通常時: High / Low

VSYNC周期: ______ ms
VSYNC パルス: ______ μs
VSYNC 通常時: High / Low

【モニター情報】
メーカー/型番: _________
エラーメッセージ: _________

【試したこと】
□ 別のモニターで試した
□ VGA入力に明示的に切り替えた
□ 極性を反転してみた
□ ピンを入れ替えてみた
```

この情報があれば、さらに詳しく診断できます！
